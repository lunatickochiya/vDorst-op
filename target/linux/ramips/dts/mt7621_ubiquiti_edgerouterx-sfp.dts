/dts-v1/;

#include "mt7621_ubiquiti_edgerouterx.dtsi"

/ {
	model = "UBNT-ERX-SFP";
	compatible = "ubiquiti,edgerouterx-sfp", "mediatek,mt7621-soc";

	sfp_eth5: sfp_eth5 {
		compatible = "sff,sfp";
		i2c-bus = <&i2c>;
		mod-def0-gpio = <&expander0 5 GPIO_ACTIVE_LOW>;
		maximum-power-milliwatt = <1000>;
	};
};

&i2c {
	status = "okay";

	expander0: pca9555@25 {
		compatible = "nxp,pca9555";
		interrupt-parent = <&gpio>;
		interrupts = <8 IRQ_TYPE_EDGE_FALLING>;
		gpio-controller;
		#gpio-cells = <2>;
		reg = <0x25>;
	};
};

&mdio {
	ephy5: ethernet-phy@7 {
		reg = <7>;
		sfp = <&sfp_eth5>;
	};
};

&switch0 {
	ports {
		port@5 {
			reg = <5>;
			label = "eth5";
			phy-handle = <&ephy5>;
			phy-mode = "rgmii-rxid";
		};
	};
};

&gpio {
	sfp_i2c_clk_gate {
		gpio-hog;
		gpios = <7 GPIO_ACTIVE_LOW>;
		output-high;
	};
};
